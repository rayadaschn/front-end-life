---
title: ç›‘å¬é”®ç›˜æŒ‰é”®
icon: javascript
date: 2024-06-22
category:
  - javascript
tag:
  - javascript
sticky: false
---

æœ¬é—®å°†æ¢³ç†ä¸€éåœ¨ js ä¸­å¦‚ä½•å»ç›‘å¬é”®ç›˜æŒ‰é”®ã€‚

<!-- more -->

## ç›‘å¬é”®ç›˜æŒ‰é”®

åœ¨ js ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `addEventListener` æ–¹æ³•æ¥ç›‘å¬é”®ç›˜æŒ‰é”®ã€‚å…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š

```js
document.addEventListener('keydown', function (event) {
  // åœ¨è¿™é‡Œç¼–å†™æŒ‰é”®è¢«æŒ‰ä¸‹çš„é€»è¾‘
})
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ`keydown` æ˜¯ä¸€ä¸ªäº‹ä»¶ç±»å‹ï¼Œè¡¨ç¤ºç›‘å¬é”®ç›˜æŒ‰é”®äº‹ä»¶ã€‚å½“ç”¨æˆ·æŒ‰ä¸‹é”®ç›˜ä¸Šçš„æŒ‰é”®æ—¶ï¼Œä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œå¹¶åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æ‰§è¡Œç›¸åº”çš„é€»è¾‘ã€‚

è¦è·å–ç”¨æˆ·æŒ‰ä¸‹çš„æŒ‰é”®ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶å¯¹è±¡çš„ `key` å±æ€§ã€‚è¯¥å±æ€§ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç”¨æˆ·æŒ‰ä¸‹çš„æŒ‰é”®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·æŒ‰ä¸‹äº† `A` é”®ï¼Œ`key` å±æ€§çš„å€¼å°†ä¼šæ˜¯ `"A"`ã€‚

## ASCII ç¼–ç 

è‹¥æ˜¯ä¾æ® `event.key` å±æ€§å€¼æ¥ç›‘å¬é”®ç›˜çš„å„ç§æŒ‰é”®ï¼Œæ— éœ€å¯¹å„ä¸ªæŒ‰é”®æ¥ä¸€æ¬¡åˆ¤æ–­ï¼Œå› ä¸º `event.key` å±æ€§å€¼ä¼šè¿”å›å¯¹åº”æŒ‰é”®çš„ ASCII ([RFC 20](https://datatracker.ietf.org/doc/html/rfc20)) ç¼–ç å€¼ã€‚

å…¶ä¸­æ•°å­— 0-9 çš„ ASCII ç¼–ç å€¼åˆ†åˆ«ä¸º 48-57ï¼Œå¤§å†™å­—æ¯ A-Z çš„ ASCII ç¼–ç å€¼åˆ†åˆ«ä¸º 65-90ï¼Œå°å†™å­—æ¯ a-z çš„ ASCII ç¼–ç å€¼åˆ†åˆ«ä¸º 97-122ã€‚

ç”±æ­¤å¯ä»¥å¾—åˆ°ç¬¬ä¸€ä¸ªæŒ‰é”®ç›‘å¬å¤„ç†å‡½æ•°:

```js
/** æŒ‰é”®ç›‘å¬å™¨å‡½æ•° */
function listenForKeyPress(callback) {
  // ç›‘å¬ keydown äº‹ä»¶
  document.addEventListener('keydown', function (event) {
    // è·å–æŒ‰é”®ä»£ç 
    const keyCode = event.keyCode

    // æ£€æŸ¥æ˜¯å¦æ˜¯ a-z ã€A-Z å’Œ 0-9
    const isLetter =
      (keyCode >= 48 && keyCode <= 57) || (keyCode >= 65 && keyCode <= 90)
    const isNumber = keyCode >= 48 && keyCode <= 57

    // å¦‚æœæ˜¯ç¬¦åˆæ¡ä»¶çš„æŒ‰é”®ï¼Œè°ƒç”¨å›è°ƒå‡½æ•°
    if (isLetter || isNumber) {
      callback(event)
    }
  })
}

// ä½¿ç”¨ç¤ºä¾‹
listenForKeyPress(function (event) {
  console.log(`ğŸš€ ~ You pressed: ${event.key}`)
})
```

## è¢«æ·˜æ±°çš„`KeyboardEvent.keyCode`

å€¼å¾—æ³¨æ„çš„æ˜¯ `KeyboardEvent.keyCode` å±æ€§å·²ç»è¢«åºŸå¼ƒäº†ï¼Œä½†æ˜¯ç›®å‰ä¸»æµæµè§ˆå™¨ç›®å‰ä»æ—§å¯ä»¥ä½¿ç”¨è¯¥å±æ€§æ¥ç›‘å¬é”®ç›˜æŒ‰é”®ã€‚å› æ­¤å¯è½¬ç”¨ `KeyboardEvent.key` æˆ–è€… `KeyboardEvent.code` æ¥æ£€æµ‹æŒ‰é”®ã€‚å®ƒä»¬ä¸‰è€…çš„åŒºåˆ«å¦‚ä¸‹:

1. [`KeyboardEvent.keyCode`](https://developer.mozilla.org/zh-CN/docs/Web/API/KeyboardEvent/keyCode#%E9%94%AE%E7%A0%81%E5%80%BCÃ¥):
   - ç±»å‹: æ•°å­—
   - å†…å®¹: è¡¨ç¤ºç‰©ç†æŒ‰é”®çš„æ•°å­—ä»£ç 
   - ç‰¹ç‚¹: ~~å·²è¢«åºŸå¼ƒ~~ï¼Œä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºå®ƒåœ¨ä¸åŒæµè§ˆå™¨å’Œé”®ç›˜å¸ƒå±€ä¸­ä¸ä¸€è‡´ã€‚
2. `KeyboardEvent.key`:
   - ç±»å‹: å­—ç¬¦ä¸²
   - å†…å®¹: è¡¨ç¤ºæŒ‰é”®çš„å€¼ï¼Œå’Œç”¨æˆ·æŒ‰ä¸‹çš„é”®ç›¸å…³ã€‚æ¯”å¦‚ï¼ŒæŒ‰ä¸‹ `a` é”®æ—¶ï¼Œè¿”å› `"a"`ï¼ŒæŒ‰ä¸‹ `Shift + a` æ—¶ï¼Œè¿”å› `"A"`ã€‚
   - ç‰¹ç‚¹: **åŒºåˆ†å¤§å°å†™**ï¼Œåæ˜ ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ï¼Œ**æ”¯æŒä¸åŒçš„é”®ç›˜å¸ƒå±€**ã€‚
3. `KeyboardEvent.code`:
   - ç±»å‹: å­—ç¬¦ä¸²
   - å†…å®¹: è¡¨ç¤ºç‰©ç†æŒ‰é”®çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼ŒQWERTY å¸ƒå±€é”®ç›˜ä¸Šçš„ `â€œqâ€` é”®è¿”å›çš„ code æ˜¯ `â€œKeyQâ€` ï¼Œä½† Dvorak é”®ç›˜ä¸Šçš„`â€œ'â€` é”®å’Œ AZERTY é”®ç›˜ä¸Šçš„`â€œaâ€`é”®ä¹Ÿè¿”å›çš„ç›¸åŒ code å€¼ã€‚
   - ç‰¹ç‚¹: ç¨³å®šæ€§ä¸å¦‚`KeyboardEvent.key`ã€‚

å› æ­¤ç›®å‰ï¼Œæœ€ä¸ºç¨³å¦¥çš„æ˜¯é‡‡ç”¨ `KeyboardEvent.key` ç”¨å­—ç¬¦ä¸²å»ç›‘å¬æŒ‰é”®äº‹ä»¶ã€‚

1. æ–¹å¼ä¸€ï¼šç›´æ¥å®šä¹‰æ‰€æœ‰æœ‰æ•ˆæŒ‰é”®ã€‚

   ```js
   // ç›´æ¥å®šä¹‰æ‰€æœ‰æœ‰æ•ˆæŒ‰é”®
   const validKeys =
     'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'

   const key = event.key

   // æ£€æŸ¥æŒ‰é”®æ˜¯å¦åœ¨æœ‰æ•ˆæŒ‰é”®é›†åˆä¸­
   if (validKeys.includes(key)) {
     console.log(`ğŸš€ ~ You pressed: ${key}`)
   }
   ```

2. æ–¹å¼äºŒï¼šç”¨æ­£åˆ™æ£€æµ‹å­—ç¬¦ã€‚

   ```js
   // æŒ‰é”®ç›‘å¬å™¨å‡½æ•°
   function listenForKeyPress(callback) {
     // ç›‘å¬ keydown äº‹ä»¶
     document.addEventListener('keydown', function (event) {
       // è·å–æŒ‰é”®å€¼
       const key = event.key

       // æ£€æŸ¥æ˜¯å¦æ˜¯ A-Z a-z æˆ– 0-9
       const isLetter = /^[A-Za-z]$/.test(key)
       const isNumber = /^[0-9]$/.test(key)

       // å¦‚æœæ˜¯ç¬¦åˆæ¡ä»¶çš„æŒ‰é”®ï¼Œè°ƒç”¨å›è°ƒå‡½æ•°
       if (isLetter || isNumber) {
         callback(event)
       }
     })
   }

   // ä½¿ç”¨ç¤ºä¾‹
   listenForKeyPress(function (event) {
     console.log(`ğŸš€ ~ You pressed: ${event.key}`)
   })
   ```
